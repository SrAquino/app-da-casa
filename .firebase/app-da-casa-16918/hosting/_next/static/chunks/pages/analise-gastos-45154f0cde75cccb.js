(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27],{8488:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/analise-gastos",function(){return a(97)}])},8636:(e,s,a)=>{"use strict";a.d(s,{A:()=>d});var t=a(4848),l=a(6540),r=a(1106),o=a.n(r),i=a(3914),n=a(2490),c=a.n(n);let d=()=>{let[e,s]=(0,l.useState)(!1);return(0,t.jsxs)("div",{className:"".concat(c().sidebar," ").concat(e?c().expanded:c().collapsed),children:[(0,t.jsx)("button",{onClick:()=>{s(!e)},className:c().toggleButton,children:e?"Esconder":(0,t.jsx)(i.OXb,{})}),(0,t.jsx)("h2",{children:"Menu"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)(o(),{href:"/controle-de-gastos",children:e?"Controle de Gastos":(0,t.jsx)(i.MxO,{})})}),(0,t.jsx)("li",{children:(0,t.jsx)(o(),{href:"/analise-gastos",children:e?"Gr\xe1ficos":(0,t.jsx)(i.qvi,{})})}),(0,t.jsx)("li",{children:(0,t.jsx)(o(),{href:"/lista-de-compras",children:e?"Lista de Compras":(0,t.jsx)(i.AsH,{})})}),(0,t.jsx)("li",{children:(0,t.jsx)(o(),{href:"/analise-mercado",children:e?"Pre\xe7os de mercado":(0,t.jsx)(i.qvi,{})})}),(0,t.jsx)("li",{children:(0,t.jsx)(o(),{href:"/moedas-da-casa",children:e?"Moedas da Casa":(0,t.jsx)(i.cEG,{})})})]})]})}},97:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var t=a(4848),l=a(6540),r=a(8636),o=a(7525),i=a(4731),n=a(6118),c=a(6784),d=a.n(c);n.t1.register(n.PP,n.kc,n.E8,n.hE,n.m_,n.s$,n.Bs);let u=()=>{let[e,s]=(0,l.useState)([]),[a,n]=(0,l.useState)(new Date().toISOString().slice(0,7)),[c,u]=(0,l.useState)({}),[h,p]=(0,l.useState)([]),[x,j]=(0,l.useState)(""),[m,_]=(0,l.useState)("Total total"),[g,b]=(0,l.useState)(3),[v,f]=(0,l.useState)([,,,].fill("")),[C,N]=(0,l.useState)([]),[y,F]=(0,l.useState)([]),E=["Mercado","A\xe7ougue","Padaria","Horti","Pet","Contas","Lazer","Transporte","Outros","Rela\xe7\xe3o passada"];(0,l.useEffect)(()=>{if(a){let[e,t]=a.split("-"),l="".concat(t).concat(e);(0,o.ck)(l).then(e=>{s(e);let a=e.reduce((e,s)=>("Total"===s.type&&(e[s.user]=(e[s.user]||0)+parseFloat(s.value)),e),{});u(a),p(Object.keys(a))}).catch(e=>console.error("Error fetching expenses:",e))}},[a]);let S=e.filter(e=>"Total total"===m||("Individual"===m?e.user===x&&"Individual"===e.type:"Total da casa"===m?"Total"===e.type:!!("Controle"===m&&("Individual"===e.type&&e.user===x||"Total"===e.type||"Selecionados"===e.type&&(e.selectedUsers.includes(x)||e.user===x))))),T=E.reduce((e,s)=>(e[s]=h.map(e=>S.filter(a=>"Total total"===m||"Individual"===m||"Total da casa"===m?a.user===e&&a.category===s:!!("Controle"===m&&("Individual"===a.type&&a.user===e&&a.category===s||"Total"===a.type&&a.category===s||"Selecionados"===a.type&&(a.selectedUsers.includes(e)||a.user===e)&&a.category===s))).reduce((s,a)=>{if("Controle"===m){if("Total"===a.type)return s+parseFloat(a.value)/h.length;if("Selecionados"===a.type)return"Rela\xe7\xe3o passada"===a.category?s+(a.selectedUsers.includes(e)?parseFloat(a.value):0):s+parseFloat(a.value)/(a.selectedUsers.length+1)}return s+parseFloat(a.value)},0)),e),{}),k=Object.values(T).flat().reduce((e,s)=>e+s,0),I=h.reduce((e,s,a)=>{let t=s.charAt(0).toUpperCase();return e[s]="hsl(".concat((t.charCodeAt(0)-65)*15,", 70%, 50%)"),e},{}),P={labels:E,datasets:h.map((e,s)=>({label:e,data:E.map(e=>T[e][s]),backgroundColor:I[e]}))},O={labels:E,datasets:[{label:"Gastos por Categoria (%)",data:E.map(e=>T[e].reduce((e,s)=>e+s,0)/k*100),backgroundColor:["#FF6384","#36A2EB","#FFCE56","#FF9F40","#4BC0C0","#9966FF","#FF6384","#36A2EB","#FFCE56"]}]},R=E.reduce((e,s)=>(e[s]=S.filter(e=>e.category===s).reduce((e,s)=>"Total"===s.type?e+parseFloat(s.value)/h.length:"Selecionados"===s.type?"Rela\xe7\xe3o passada"===s.category?e+(s.selectedUsers.includes(x)?parseFloat(s.value):0):e+parseFloat(s.value)/(s.selectedUsers.length+1):"Individual"===s.type&&s.user===x?e+parseFloat(s.value):e,0),e),{}),U=(e,s)=>{let a=[...v];a[e]=s,f(a)};return(0,t.jsxs)("div",{className:d().container,children:[(0,t.jsx)(r.A,{}),(0,t.jsxs)("div",{className:d().content,children:[(0,t.jsx)("h1",{className:d().title,children:"An\xe1lise de Gastos"}),(0,t.jsxs)("div",{className:d().filterContainer,children:[(0,t.jsx)("label",{htmlFor:"month",className:d().label,children:"Selecione o m\xeas:"}),(0,t.jsx)("input",{type:"month",id:"month",value:a,onChange:e=>n(e.target.value),className:d().input}),(0,t.jsx)("label",{htmlFor:"expenseType",className:d().label,children:"Tipo de Gasto:"}),(0,t.jsxs)("select",{id:"expenseType",value:m,onChange:e=>_(e.target.value),className:d().input,children:[(0,t.jsx)("option",{value:"Total total",children:"Total total"}),(0,t.jsx)("option",{value:"Individual",children:"Individual"}),(0,t.jsx)("option",{value:"Total da casa",children:"Total da casa"}),(0,t.jsx)("option",{value:"Controle",children:"Controle"})]}),("Individual"===m||"Controle"===m)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"user",className:d().label,children:"Selecione o usu\xe1rio:"}),(0,t.jsxs)("select",{id:"user",value:x,onChange:e=>j(e.target.value),className:d().input,children:[(0,t.jsx)("option",{value:"",children:"Selecione um usu\xe1rio"}),h.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),"Individual"===m&&(0,t.jsx)("p",{className:d().description,children:"Esta op\xe7\xe3o exibe os gastos individuais feitos pelo usu\xe1rio selecionado"}),"Controle"===m&&(0,t.jsx)("p",{className:d().description,children:"Esta op\xe7\xe3o exibe os gastos divididos a serem pagos"})]}),"Total total"===m&&(0,t.jsx)("p",{className:d().description,children:"Esta op\xe7\xe3o exibe todos os gastos feitos por todos os usu\xe1rios da casa"}),"Total da casa"===m&&(0,t.jsx)("p",{className:d().description,children:"Esta op\xe7\xe3o mostra apenas os gastos que ser\xe3o divididos para todos os membros da casa"})]}),(0,t.jsxs)("div",{className:d().analysisContainer,children:[(0,t.jsx)("div",{className:d().tableContainer,children:(0,t.jsxs)("table",{className:d().table,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Categoria"}),(0,t.jsx)("th",{children:"Valor"})]})}),(0,t.jsx)("tbody",{children:a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"M\xeas"}),(0,t.jsx)("td",{children:a})]}),E.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e}),(0,t.jsxs)("td",{children:["R$","Controle"===m?R[e].toFixed(2):T[e].reduce((e,s)=>e+s,0).toFixed(2)]})]},e)),(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Total"}),(0,t.jsxs)("td",{children:["R$","Controle"===m?Object.values(R).reduce((e,s)=>e+s,0).toFixed(2):k.toFixed(2)]})]})]})})]})}),(0,t.jsx)("div",{className:d().chartContainer,children:(0,t.jsx)(i.yP,{data:P,options:{scales:{x:{stacked:!0},y:{stacked:!0}}}})}),(0,t.jsx)("div",{className:d().chartContainer,children:(0,t.jsx)(i.Fq,{data:O})})]}),(0,t.jsxs)("div",{className:d().parallelExpenses,children:[(0,t.jsx)("h2",{children:"Despesas Paralelas"}),(0,t.jsxs)("table",{className:d().table,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Pagador"}),(0,t.jsx)("th",{children:"Devedor"}),(0,t.jsx)("th",{children:"Valor"})]})}),(0,t.jsx)("tbody",{children:e.filter(e=>"Selecionados"===e.type).map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.user}),(0,t.jsx)("td",{children:e.selectedUsers.join(", ")}),(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:d().tooltip,"data-tooltip":"".concat(e.category,": ").concat(e.description||"Sem coment\xe1rio"),children:["R$",parseFloat(e.value).toFixed(2)]})})]},e.id))})]}),(0,t.jsx)("button",{onClick:()=>{let s=e.filter(e=>"Selecionados"===e.type),a={};s.forEach(e=>{let s=e.selectedUsers.length+1,t=parseFloat(e.value)/s;e.selectedUsers.forEach(s=>{a[s]||(a[s]={}),a[s][e.user]||(a[s][e.user]=0),a[s][e.user]+=t})});let t=[];Object.keys(a).forEach(e=>{Object.keys(a[e]).forEach(s=>{if(a[s]&&a[s][e]){let l=a[e][s]-a[s][e];l>0?t.push({from:e,to:s,amount:l.toFixed(2)}):l<0&&t.push({from:s,to:e,amount:(-l).toFixed(2)}),delete a[s][e]}else t.push({from:e,to:s,amount:a[e][s].toFixed(2)})})}),F(t)},className:d().button,children:"Calcular Despesas Paralelas"}),(0,t.jsxs)("div",{className:d().transactions,children:[y.length>0&&(0,t.jsx)("h3",{className:d().subtitle,children:"Pagamentos necess\xe1rios:"}),y.map((e,s)=>(0,t.jsxs)("p",{className:d().transactionItem,children:[e.from," deve pagar R$ ",e.amount," para ",e.to]},s))]})]}),(0,t.jsxs)("div",{className:d().userExpenses,children:[(0,t.jsx)("h2",{children:"Gastos por Usu\xe1rio"}),(0,t.jsx)("ul",{children:h.map(e=>(0,t.jsxs)("li",{children:[e,": R$",(c[e]||0).toFixed(2)]},e))})]}),(0,t.jsxs)("div",{className:d().expenseSplitter,children:[(0,t.jsx)("h2",{className:d().title,children:"Divisor de Despesas"}),(0,t.jsx)("label",{className:d().label,children:"N\xfamero de moradores:"}),(0,t.jsx)("input",{type:"number",value:g,onChange:e=>{let s=parseInt(e.target.value,10)||1;b(s),f(Array(s).fill("")),N([])},className:d().input,min:"1"}),v.map((e,s)=>(0,t.jsxs)("div",{className:d().splitExpenseItem,children:[(0,t.jsxs)("label",{children:["Morador ",s+1,":"]}),(0,t.jsx)("input",{type:"number",value:e,onChange:e=>U(s,e.target.value),className:d().input})]},s)),(0,t.jsx)("button",{onClick:()=>{let e=v.length,s=v.map(e=>parseFloat(e)||0),a=s.reduce((e,s)=>e+s,0)/e,t=s.map(e=>e-a),l=[],r=[];t.forEach((e,s)=>{e<0&&l.push([s,-e]),e>0&&r.push([s,e])});let o=[],i=0,n=0;for(;i<l.length&&n<r.length;){let[e,s]=l[i],[a,t]=r[n],c=Math.min(s,t);o.push({from:e+1,to:a+1,amount:c.toFixed(2)}),l[i][1]-=c,r[n][1]-=c,0===l[i][1]&&i++,0===r[n][1]&&n++}N(o)},className:d().button,children:"Calcular Pagamentos"}),(0,t.jsxs)("div",{className:d().transactions,children:[C.length>0&&(0,t.jsx)("h3",{className:d().subtitle,children:"Pagamentos necess\xe1rios:"}),C.map((e,s)=>(0,t.jsxs)("p",{className:d().transactionItem,children:["Morador ",e.from," deve pagar R$ ",e.amount," para Morador ",e.to]},s))]})]})]})]})}},2490:e=>{e.exports={sidebar:"Sidebar_sidebar__HYpoR",collapsed:"Sidebar_collapsed__jq1k3",toggleButton:"Sidebar_toggleButton__u5PL9",expanded:"Sidebar_expanded__t69bD"}},6784:e=>{e.exports={container:"graficos_container__8QRSM",sidebar:"graficos_sidebar__fnf_H",content:"graficos_content__r4OTS",title:"graficos_title__gz74L",filterContainer:"graficos_filterContainer__sC8NO",label:"graficos_label__bUlN9",input:"graficos_input__BX232",table:"graficos_table__eun5v",tableContainer:"graficos_tableContainer__aJQSP",tableHeader:"graficos_tableHeader__crHPN",tableRow:"graficos_tableRow__ssj1a",tableCell:"graficos_tableCell__E3gkI",chartContainer:"graficos_chartContainer__PasbD",userExpenses:"graficos_userExpenses__kkcTx",debtMessages:"graficos_debtMessages__ltWci",expenseSplitter:"graficos_expenseSplitter__lKK_O",splitExpenseItem:"graficos_splitExpenseItem___jEyA",transactions:"graficos_transactions__qwOBz",transactionItem:"graficos_transactionItem__vj_VL",analysisContainer:"graficos_analysisContainer__T7EuH",tooltip:"graficos_tooltip__HCYX_",button:"graficos_button__DXi1U"}}},e=>{var s=s=>e(e.s=s);e.O(0,[563,201,705,888,636,593,792],()=>s(8488)),_N_E=e.O()}]);